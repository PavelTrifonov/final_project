# Telegram Бот для Мониторинга Токсичности Сообщений

## Описание проекта

Проект представляет собой Telegram-бота, который отслеживает токсичность сообщений в групповых чатах. Бот использует предварительно обученную модель для классификации сообщений на токсичные и не токсичные. В зависимости от уровня токсичности бот либо предупреждает пользователя, либо удаляет его сообщение. Бот взаимодействует с сервером Flask, который обрабатывает запросы и возвращает предсказания токсичности. Действия бота зависят от уровня токсичности:
- Если токсичность составляет от 80% до 90%, бот предупреждает пользователя, обращаясь к нему по имени.
- Если токсичность превышает 90%, бот удаляет сообщение и оставляет комментарий, объясняя причину удаления и также обращаясь к пользователю по имени.

### Основные функции

- **Классификация токсичности**: Бот отправляет текст сообщения на сервер Flask для классификации и получает результат в виде уровня токсичности.
- **Предупреждение и удаление**:
  - Если токсичность составляет от 80% до 90%, бот отправляет пользователю предупреждение.
  - Если токсичность превышает 90%, бот удаляет сообщение с указанием причины.
- **Масштабируемость**: Бот может обрабатывать несколько сообщений одновременно и динамически взаимодействовать с моделью для предсказания токсичности.
- **Логирование**: Все запросы и ответы сервера логируются для целей мониторинга.

## Установка и настройка

### Предварительные требования

Убедитесь, что у вас установлены следующие компоненты:
- **Python 3.7** или выше
- **aiohttp**, **aiogram**, **Flask** и другие необходимые пакеты из `requirements.txt`

### Клонирование проекта

Для начала работы с проектом клонируйте репозиторий:

```bash
git clone https://github.com/YourRepo/YourProject.git
cd YourProject
```
### Создание виртуального окружения

Для управления зависимостями создайте и активируйте виртуальное окружение:

#### Для Linux/macOS:

```bash
python3 -m venv venv
source venv/bin/activate
```

#### Для Windows:

```bash
python -m venv venv
venv\Scripts\activate
```

### Установка зависимостей

После активации виртуального окружения установите необходимые зависимости командой:

```bash
pip install -r requirements.txt
```
### Добавление токена Telegram бота

Для подключения к Telegram боту необходим API токен. Добавьте ваш токен, создав файл token.txt в папке app и вставив туда ваш токен.

### Запуск приложения

Для запуска бота и сервера выполните команду:

```bash
python main.py
```
Это:
1. Запустит Telegram-бота.
2. Запустит сервер Flask для обработки запросов по классификации токсичности.

Сервер будет запущен локально по адресу http://localhost:5000.


## Использование Docker
### Шаг 1: 
Создайте образ Docker:
```bash
docker build -t telegram-toxic-bot
```
### Шаг 2: 
Запустите контейнер:
```bash
docker run -d -p 5000:5000 telegram-toxic-bot
```

### Инструкции по использованию

После запуска бота:
1. Добавьте бота в ваш Telegram-чат.
2. Бот будет мониторить сообщения и реагировать в зависимости от уровня их токсичности.

### Веб-интерфейс

Вы также можете взаимодействовать с моделью через веб-интерфейс Flask. Отправляйте POST-запросы на маршрут /classify с текстом сообщения в формате JSON:

```bash
curl -X POST http://localhost:5000/classify -H "Content-Type: application/json" -d '{"message": "example message"}'
```

Ответ вернёт уровень токсичности и метку (токсично или нет).

### Структура проекта

```bash
YourProject/
│
├── app/
│   ├── main.py                # Точка входа для бота и сервера
│   ├── bot.py                 # Логика Telegram бота
│   ├── server.py              # Flask сервер для модели токсичности
│   ├── model.py               # Реализация модели токсичности
│   └── token.txt              # Файл с токеном Telegram API
├── requirements.txt           # Зависимости Python
├── Dockerfile                 # Инструкции для сборки образа
├── docker-entrypoint.sh       # Сценарий на запуск контейнера
├── README.md                  # Документация проекта
└── venv/                      # Виртуальное окружение
```

### Логирование

Проект логирует все входящие запросы и исходящие ответы для мониторинга взаимодействия между Telegram ботом и сервером Flask. Логи доступны в журнале работы Flask.

